<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Reviews</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel for in-browser JSX transpilation -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Simple fade-in animation for modals */
        @keyframes fade-in {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in {
            animation: fade-in 0.2s ease-out forwards;
        }
        /* Custom font for search icon */
        .font-mono {
            font-family: 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', "Liberation Mono", "Courier New", monospace;
        }
    </style>
</head>
<body class="bg-gray-900">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- Hardcoded Book Data ---
        const hardcodedBooks = 
        [
            // -- 2025 Books --
            {title: "Winter World", author: "A.G. Riddle", series: "Long Winter Trilogy", genre: "Sci-Fi", rating: 3, dateFinished: "2025", pages: 470, review: "" },
            {title: "Empire of Silence", author: "Christopher Ruocchio", series: "Sun Eater", genre: "Sci-Fi", rating: 1, dateFinished: "2025", pages: 736, review: "" },
            {title: "The Fifth Season", author: "N.K. Jemisin", series: "Broken Earth", genre: "Fantasy", rating: 2, dateFinished: "2025", pages: 512, review: "" },
            {title: "Persepolis Rising", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 4, dateFinished: "2025", pages: 560, review: "" },
            {title: "The Threads of Then and Now", author: "Meagen Boulay", series: "", genre: "Fantasy", rating: 5, dateFinished: "2025", pages: 383, review: "" },
            {title: "Concrete Island", author: "J. G. Ballard", series: "", genre: "Sci-Fi", rating: 2, dateFinished: "2025", pages: 176, review: "" },
            {title: "Into Thin Air", author: "Jon Krakauer", series: "", genre: "Biography,Travel", rating: 4, dateFinished: "2025", pages: 332, review: "" },
            {title: "Memory's Legion", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 4, dateFinished: "2025", pages: 0, review: "" },
            {title: "A Man Called Ove", author: "Fredrik Backman", series: "", genre: "Fiction", rating: 4, dateFinished: "2025", pages: 368, review: "" },
            {title: "The Undead Fox of Deadwood Forest", author: "Aubrey Hartman", series: "", genre: "YoungAdult,Fantasy", rating: 5, dateFinished: "2025", pages: 320, review: "" },
            {title: "Leviathan Falls", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 5, dateFinished: "2025", pages: 560, review: "" },
            {title: "Tiamat's Wrath", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 4, dateFinished: "2025", pages: 576, review: "" },
            // -- 2024 Books --
            {title: "Babylon's Ashes", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 5, dateFinished: "2024", pages: 576, review: "" },
            {title: "Nemesis Games", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 5, dateFinished: "2024", pages: 624, review: "" },
            {title: "Abaddon's Gate", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 5, dateFinished: "2024", pages: 576, review: "" },
            {title: "Cibola Burn", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 5, dateFinished: "2024", pages: 624, review: "" },
            {title: "Leviathan Wakes", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 592, review: "" },
            {title: "Caliban's War", author: "James S.A. Corey", series: "The Expanse", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 624, review: "" },
            {title: "Ark", author: "Veronica Roth", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 45, review: "" },
            {title: "Randomize", author: "Andy Weir", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 32, review: "" },
            {title: "Summer Frost", author: "Blake Crouch", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 85, review: "" },
            {title: "Absolution", author: "Jeff Vandermeer", series: "Southern Reach", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 464, review: "" },
            {title: "The Sparrow", author: "Mary Doria Russell", series: "", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 517, review: "" },
            {title: "The Count of Monte Cristo", author: "Alexandre Dumas", series: "", genre: "Classic", rating: 4, dateFinished: "2024", pages: 1138, review: "" },
            {title: "The Blade Itself", author: "Joe Abercrombie", series: "The First Law Trilogy", genre: "Fantasy", rating: 4, dateFinished: "2024", pages: 560, review: "" },
            {title: "The Forever War", author: "Joe Haldeman", series: "The Forever War", genre: "Sci-Fi", rating: 4, dateFinished: "2024", pages: 264, review: "" },
            {title: "Devolution", author: "Max Brooks", series: "", genre: "Thriller", rating: 4, dateFinished: "2024", pages: 288, review: "" },
            {title: "Termination Shock", author: "Neal Stephenson", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2024", pages: 720, review: "" },
            {title: "The Gentleman In Moscow", author: "Amor Towles", series: "", genre: "Historical Fiction", rating: 3, dateFinished: "2024", pages: 465, review: "" },
            {title: "The Egg and Other Stories", author: "Andy Weir", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2024", pages: 128, review: "" },
            {title: "Emergency Skin", author: "N.K. Jemisin", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 3, dateFinished: "2024", pages: 38, review: "" },
            {title: "Six of Crows", author: "Leigh Bardugo", series: "Six of Crows", genre: "Fantasy", rating: 3, dateFinished: "2024", pages: 495, review: "" },
            {title: "Crooked Kingdom", author: "Leigh Bardugo", series: "Six of Crows", genre: "Fantasy", rating: 3, dateFinished: "2024", pages: 578, review: "" },
            {title: "Sh≈çgun, Part One", author: "James Clavell", series: "The Asian Saga", genre: "Historical Fiction", rating: 3, dateFinished: "2024", pages: 699, review: "" },
            {title: "Vengeful", author: "V.E. Schwab", series: "Villains", genre: "Fantasy,Superhero", rating: 3, dateFinished: "2024", pages: 462, review: "" },
            {title: "The Land of Lost Things", author: "John Connolly", series: "The Book Of Lost Things", genre: "Coming of Age,Fantasy", rating: 3, dateFinished: "2024", pages: 364, review: "" },
            {title: "Oryx and Crake", author: "Margaret Atwood", series: "The MaddAddam Trilogy", genre: "Dystopian", rating: 3, dateFinished: "2024", pages: 389, review: "" },
            {title: "Vicious", author: "V.E. Schwab", series: "Villains", genre: "Fantasy,Superhero", rating: 2, dateFinished: "2024", pages: 480, review: "" },
            {title: "Mountain in the Sea", author: "Ray Nayler", series: "", genre: "Sci-Fi", rating: 2, dateFinished: "2024", pages: 464, review: "" },
            {title: "You Have Arrived at Your Destination", author: "Amor Towles", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 2, dateFinished: "2024", pages: 54, review: "" },
            {title: "The Golem and the Jinni", author: "Helene Wecker", series: "", genre: "Fantasy", rating: 1, dateFinished: "2024", pages: 496, review: "" },
            {title: "The Last Conversation", author: "Paul Tremblay", series: "Forward: Stories of Tomorrow", genre: "Sci-Fi", rating: 1, dateFinished: "2024", pages: 67, review: "" },
            {title: "The Reddening", author: "Adam Nevill", series: "", genre: "Horror", rating: 1, dateFinished: "2024", pages: 419, review: "" },
            // -- 2023 Books --
            {title: "Acceptance", author: "Jeff VanderMeer", series: "Southern Reach", genre: "Sci-Fi", rating: 5, dateFinished: "2023", pages: 368, review: "" },
            {title: "The Adventures of Sherlock Holmes", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 5, dateFinished: "2023", pages: 104, review: "" },
            {title: "The Hound of the Baskervilles", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 5, dateFinished: "2023", pages: 188, review: "" },
            {title: "The Memoirs of Sherlock Holmes", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 5, dateFinished: "2023", pages: 194, review: "" },
            {title: "The Return of Sherlock Holmes", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 5, dateFinished: "2023", pages: 404, review: "" },
            {title: "The Saturday Night Ghost Club", author: "Craig Davidson", series: "", genre: "Horror", rating: 5, dateFinished: "2023", pages: 224, review: "" },
            {title: "The Stand", author: "Stephen King", series: "", genre: "Dystopian", rating: 5, dateFinished: "2023", pages: 1328, review: "" },
            {title: "The Terror", author: "Dan Simmons", series: "", genre: "Thriller", rating: 5, dateFinished: "2023", pages: 784, review: "" },
            {title: "The Valley of Fear", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 5, dateFinished: "2023", pages: 172, review: "" },
            {title: "World War Z", author: "Max Brooks", series: "", genre: "Horror", rating: 5, dateFinished: "2023", pages: 352, review: "" },
            {title: "2001: a Space Odyssey", author: "Arthur C. Clarke", series: "Space Odyssey", genre: "Sci-Fi", rating: 4, dateFinished: "2023", pages: 256, review: "" },
            {title: "A Study in Scarlet", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 4, dateFinished: "2023", pages: 174, review: "" },
            {title: "Authority", author: "Jeff VanderMeer", series: "Southern Reach", genre: "Sci-Fi", rating: 4, dateFinished: "2023", pages: 368, review: "" },
            {title: "Circe", author: "Madeline Miller", series: "", genre: "Mythology", rating: 4, dateFinished: "2023", pages: 416, review: "" },
            {title: "His Last Bow", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 4, dateFinished: "2023", pages: 183, review: "" },
            {title: "The Hike", author: "Drew Magary", series: "", genre: "Fantasy", rating: 4, dateFinished: "2023", pages: 288, review: "" },
            {title: "The Postmortal", author: "Drew Magary", series: "", genre: "Dystopian", rating: 4, dateFinished: "2023", pages: 400, review: "" },
            {title: "The Sign of the Four", author: "Arthur Conan Doyle", series: "Sherlock Holmes", genre: "Mystery", rating: 4, dateFinished: "2023", pages: 126, review: "" },
            {title: "And Then I Woke Up", author: "Malcolm Devlin", series: "", genre: "Horror", rating: 3, dateFinished: "2023", pages: 166, review: "" },
            {title: "Every Dead Thing", author: "John Connolly", series: "Charlie Parker", genre: "Thriller", rating: 3, dateFinished: "2023", pages: 512, review: "" },
            {title: "Quantum Radio", author: "A.G. Riddle", series: "Multiverse", genre: "Sci-Fi", rating: 3, dateFinished: "2023", pages: 512, review: "" },
            {title: "The Graveyard Book", author: "Neil Gaiman", series: "", genre: "YoungAdult,Fantasy", rating: 3, dateFinished: "2023", pages: 368, review: "" },
            {title: "The Haar", author: "David Sodergren", series: "", genre: "Horror", rating: 3, dateFinished: "2023", pages: 220, review: "" },
            {title: "The House at the End of the World", author: "Dean Koontz", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2023", pages: 398, review: "" },
            {title: "The Rover", author: "Drew Magary", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2023", pages: 23, review: "" },
            {title: "The Song of Achilles", author: "Madeline Miller", series: "", genre: "Mythology", rating: 3, dateFinished: "2023", pages: 408, review: "" },
            {title: "The Way of Shadows", author: "Brent Weeks", series: "Night Angel", genre: "Fantasy", rating: 3, dateFinished: "2023", pages: 645, review: "" },
            {title: "Cloud Atlas", author: "David Mitchell", series: "", genre: "Sci-Fi", rating: 2, dateFinished: "2023", pages: 509, review: "" },
            {title: "Crooked House", author: "Agatha Christie", series: "", genre: "Mystery", rating: 2, dateFinished: "2023", pages: 256, review: "" },
            {title: "Gideon the Ninth", author: "Tamsyn Muir", series: "The Locked Tomb", genre: "Fantasy", rating: 2, dateFinished: "2023", pages: 496, review: "" },
            {title: "The Deep", author: "Nick Cutter", series: "", genre: "Horror", rating: 1, dateFinished: "2023", pages: 416, review: "" },
            // -- 2022 Books --
            {title: "Furies of Calderon", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 5, dateFinished: "2022", pages: 688, review: "" },
            {title: "Jurassic Park", author: "Michael Crichton", series: "Jurassic Park", genre: "Thriller", rating: 5, dateFinished: "2022", pages: 466, review: "" },
            {title: "And Then There Were None", author: "Agatha Christie", series: "", genre: "Mystery", rating: 5, dateFinished: "2022", pages: 300, review: "" },
            {title: "Klara and the Sun", author: "Kazuo Ishiguro", series: "", genre: "Sci-Fi", rating: 5, dateFinished: "2022", pages: 320, review: "" },
            {title: "Project Hail Mary", author: "Andy Weir", series: "", genre: "Sci-Fi", rating: 5, dateFinished: "2022", pages: 496, review: "" },
            {title: "We Have Always Lived in the Castle", author: "Shirley Jackson", series: "", genre: "Gothic,Thriller", rating: 5, dateFinished: "2022", pages: 146, review: "" },
            {title: "Academ'‚Äô's Fury", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 4, dateFinished: "2022", pages: 722, review: "" },
            {title: "Captain'‚Äô's Fury", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 4, dateFinished: "2022", pages: 476, review: "" },
            {title: "Cursor'‚Äô's Fury", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 4, dateFinished: "2022", pages: 705, review: "" },
            {title: "First Lord'‚Äô's Fury", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 4, dateFinished: "2022", pages: 705, review: "" },
            {title: "Princeps'‚Äô' Fury", author: "Jim Butcher", series: "Codex Alera", genre: "Fantasy", rating: 4, dateFinished: "2022", pages: 412, review: "" },
            {title: "The Lost World", author: "Michael Crichton", series: "Jurassic Park", genre: "Thriller", rating: 4, dateFinished: "2022", pages: 448, review: "" },
            {title: "All the Pretty Horses", author: "Cormac McCarthy", series: "The Border Trilogy", genre: "Western", rating: 4, dateFinished: "2022", pages: 301, review: "" },
            {title: "Gulp: Adventures on the Alimentary Canal", author: "Mary Roach", series: "", genre: "Science", rating: 4, dateFinished: "2022", pages: 354, review: "" },
            {title: "Sphere", author: "Michael Crichton", series: "", genre: "Thriller", rating: 4, dateFinished: "2022", pages: 528, review: "" },
            {title: "The Stranger", author: "Albert Camus", series: "", genre: "Classic", rating: 4, dateFinished: "2022", pages: 113, review: "" },
            {title: "Final Spin", author: "Jocko Willink", series: "", genre: "Thriller", rating: 3, dateFinished: "2022", pages: 208, review: "" },
            {title: "Good Omens", author: "Terry Pratchett, Neil Gaiman", series: "", genre: "Humor,Fantasy", rating: 3, dateFinished: "2022", pages: 288, review: "" },
            {title: "Nightfall and Other Stories", author: "Isaac Asimov", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2022", pages: 416, review: "" },
            {title: "The Troop", author: "Nick Cutter", series: "", genre: "Horror", rating: 3, dateFinished: "2022", pages: 384, review: "" },
            {title: "Steelheart", author: "Brandon Sanderson", series: "The Reckoners", genre: "Fantasy,Superhero", rating: 2, dateFinished: "2022", pages: 432, review: "" },
            {title: "Broken Heart of Arelium", author: "Alex Robins", series: "War of the Twelve", genre: "Fantasy", rating: 2, dateFinished: "2022", pages: 306, review: "" },
            {title: "Eaters of the Dead", author: "Michael Crichton", series: "", genre: "Historical Fiction", rating: 2, dateFinished: "2022", pages: 208, review: "" },
            {title: "20,000 Leagues Under the Sea", author: "Jules Verne", series: "", genre: "Classic", rating: 1, dateFinished: "2022", pages: 256, review: "" },
            {title: "The Listeners", author: "James Gunn", series: "", genre: "Sci-Fi", rating: 1, dateFinished: "2022", pages: 277, review: "" },
            // -- 2021 Books --
            {title: "Dune", author: "Frank Herbert", series: "Dune", genre: "Sci-Fi", rating: 5, dateFinished: "2021", pages: 704, review: "" },
            {title: "Hyperion", author: "Dan Simmons", series: "Hyperion Cantos", genre: "Sci-Fi", rating: 5, dateFinished: "2021", pages: 481, review: "" },
            {title: "Breath: The New Science of a Lost Art", author: "James Nestor", series: "", genre: "Science", rating: 5, dateFinished: "2021", pages: 304, review: "" },
            {title: "I Am Legend", author: "Richard Matheson", series: "", genre: "Dystopian", rating: 5, dateFinished: "2021", pages: 104, review: "" },
            {title: "No Country For Old Men", author: "Cormac McCarthy", series: "", genre: "Thriller", rating: 5, dateFinished: "2021", pages: 322, review: "" },
            {title: "The Road", author: "Cormac McCarthy", series: "", genre: "Dystopian", rating: 5, dateFinished: "2021", pages: 324, review: "" },
            {title: "Annihilation", author: "Jeff Vandermeer", series: "Southern Reach", genre: "Sci-Fi", rating: 4, dateFinished: "2021", pages: 224, review: "" },
            {title: "Blood Meridian", author: "Cormac McCarthy", series: "", genre: "Western", rating: 4, dateFinished: "2021", pages: 372, review: "" },
            {title: "Cryptonomicon", author: "Neal Stephenson", series: "", genre: "Thriller", rating: 4, dateFinished: "2021", pages: 1168, review: "" },
            {title: "Prey", author: "Michael Crichton", series: "", genre: "Thriller", rating: 4, dateFinished: "2021", pages: 528, review: "" },
            {title: "The Phoenix Project", author: "Gene Kim", series: "The Phoenix Project", genre: "Business", rating: 3, dateFinished: "2021", pages: 537, review: "" },
            {title: "Snow Crash", author: "Neal Stephenson", series: "", genre: "Sci-Fi", rating: 3, dateFinished: "2021", pages: 480, review: "" },
            {title: "America Before: The Key to Earth'‚Äô's Lost Civilization", author: "Graham Hancock", series: "", genre: "History", rating: 2, dateFinished: "2021", pages: 624, review: "" },
            {title: "Who Fears Death", author: "Nnedi Okorafor", series: "", genre: "Dystopian", rating: 2, dateFinished: "2021", pages: 401, review: "" },
            {title: "The Yellow Wallpaper", author: "Charlotte Perkins Gilman", series: "", genre: "Classic", rating: 1, dateFinished: "2021", pages: 21, review: "" },
            // -- 2020 Books --
            {title: "The Demon In The Freezer", author: "Richard Preston", series: "Dark Biology", genre: "Science,Biology", rating: 5, dateFinished: "2020", pages: 306, review: "" },
            {title: "Sandworm", author: "Andy Greenberg", series: "", genre: "Cyber", rating: 5, dateFinished: "2020", pages: 370, review: "" },
            {title: "The End Is Always Near", author: "Dan Carlin", series: "", genre: "History", rating: 5, dateFinished: "2020", pages: 293, review: "" },
            {title: "The Book of Lost Things", author: "John Connolly", series: "The Book Of Lost Things", genre: "Coming of Age,Fantasy", rating: 4, dateFinished: "2020", pages: 352, review: "" },
            {title: "Aurora", author: "Kim Stanley Robinson", series: "", genre: "Sci-Fi", rating: 4, dateFinished: "2020", pages: 512, review: "" },
            {title: "Black Elk", author: "Joe Jackson", series: "", genre: "Biography,History", rating: 4, dateFinished: "2020", pages: 830, review: "" },
            {title: "Exhalation: Stories", author: "Ted Chiang", series: "", genre: "Sci-Fi", rating: 4, dateFinished: "2020", pages: 362, review: "" },
            {title: "Raven Rock", author: "Garrett M. Graff", series: "", genre: "History", rating: 4, dateFinished: "2020", pages: 561, review: "" },
            {title: "Reamde", author: "Neal Stephenson", series: "", genre: "Thriller", rating: 4, dateFinished: "2020", pages: 1055, review: "" },
            {title: "Underland: A Deep Time Journey", author: "Robert Macfarlane", series: "", genre: "Science,Ecology", rating: 4, dateFinished: "2020", pages: 495, review: "" },
            {title: "The Andromeda Evolution", author: "Michael Crichton", series: "The Andromeda Strain", genre: "Sci-Fi", rating: 3, dateFinished: "2020", pages: 383, review: "" },
            {title: "All Systems Red", author: "Martha Wells", series: "Murderbot Diaries", genre: "Sci-Fi", rating: 2, dateFinished: "2020", pages: 156, review: "" },
            {title: "The Starless Sea", author: "Erin Morgenstern", series: "", genre: "Fantasy", rating: 2, dateFinished: "2020", pages: 487, review: "" },
        ];

        // --- SVG Icon Components ---
        const ArrowUpDown = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="m21 8-4-4-4 4"/><path d="M17 4v16"/></svg>
        );
        const BookIcon = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>
        );
        const PageIcon = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );
        const CalendarIcon = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
        );
        const StarIcon = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        );

        // --- Helper Components ---
        const colorPalette = [
            'bg-red-900 text-red-200', 'bg-orange-900 text-orange-200', 'bg-amber-900 text-amber-200',
            'bg-yellow-900 text-yellow-200', 'bg-lime-900 text-lime-200', 'bg-green-900 text-green-200',
            'bg-emerald-900 text-emerald-200', 'bg-teal-900 text-teal-200', 'bg-cyan-900 text-cyan-200',
            'bg-sky-900 text-sky-200', 'bg-blue-900 text-blue-200', 'bg-indigo-900 text-indigo-200',
            'bg-violet-900 text-violet-200', 'bg-purple-900 text-purple-200', 'bg-fuchsia-900 text-fuchsia-200',
            'bg-pink-900 text-pink-200', 'bg-rose-900 text-rose-200'
        ];
        const genreColorMap = {};
        let lastColorIndex = -1;

        const getGenreColorClasses = (genre) => {
            const lowerGenre = genre?.toLowerCase().trim() || '';
            if (!lowerGenre) return 'bg-gray-700 text-gray-300';
            if (genreColorMap[lowerGenre]) {
                return genreColorMap[lowerGenre];
            }
            let newColorIndex;
            do {
                newColorIndex = Math.floor(Math.random() * colorPalette.length);
            } while (newColorIndex === lastColorIndex);
            
            lastColorIndex = newColorIndex;
            const randomColor = colorPalette[newColorIndex];
            genreColorMap[lowerGenre] = randomColor;
            return randomColor;
        };

        const renderGenreBubbles = (genre) => {
            if (!genre) return null;
            const genres = genre.split(',').map(g => g.trim());
            return genres.map((g, index) => (
                <span key={index} className={`mr-1 mt-1 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getGenreColorClasses(g)}`}>{g}</span>
            ));
        };

        const getRatingColorClasses = (rating) => {
            const numericRating = parseInt(rating, 10);
            switch (numericRating) {
                case 1: return 'text-red-700 fill-red-700';
                case 2: return 'text-red-500 fill-red-500';
                case 3: return 'text-orange-500 fill-orange-500';
                case 4: return 'text-amber-400 fill-amber-400';
                case 5: return 'text-yellow-200 fill-yellow-200';
                default: return 'text-gray-400';
            }
        };

        const StarRating = ({ rating }) => {
            const numericRating = parseInt(rating, 10);
            const colorClasses = getRatingColorClasses(numericRating);
            if (isNaN(numericRating)) {
                return <span className="text-sm text-gray-400">{rating}</span>;
            }
            return (
                <div className="flex items-center">
                    {[1, 2, 3, 4, 5].map((star) => (
                        <StarIcon
                            key={star}
                            className={`w-5 h-5 ${numericRating >= star ? colorClasses : 'text-gray-600'}`}
                        />
                    ))}
                </div>
            );
        };

        const Modal = ({ children, isOpen, onClose }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4 animate-fade-in" onClick={onClose}>
                    <div className="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col" onClick={(e) => e.stopPropagation()}>
                        <main className="p-6 overflow-y-auto rounded-2xl">{children}</main>
                    </div>
                </div>
            );
        };

        // --- Metrics Components ---
        const MetricCard = ({ icon, label, value }) => (
            <div className="bg-gray-800 p-4 rounded-xl flex items-center gap-4">
                <div className="bg-gray-700 p-3 rounded-lg">{icon}</div>
                <div>
                    <div className="text-sm text-gray-400">{label}</div>
                    <div className="text-2xl font-bold text-white">{value}</div>
                </div>
            </div>
        );

        const MetricsDashboard = ({ metrics }) => (
            <div className="mb-8">
                <h2 className="text-2xl font-bold text-white mb-4">All-Time Stats</h2>
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <MetricCard icon={<BookIcon className="w-6 h-6 text-sky-400" />} label="Total Books Read" value={metrics.totalBooks.toLocaleString()} />
                    <MetricCard icon={<PageIcon className="w-6 h-6 text-lime-400" />} label="Total Pages Read" value={metrics.totalPages.toLocaleString()} />
                </div>

                <h2 className="text-2xl font-bold text-white mt-8 mb-4">By Year</h2>
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    {metrics.byYear.map(yearStats => (
                        <div key={yearStats.year} className="bg-gray-800 p-4 rounded-xl">
                            <h3 className="text-xl font-bold text-white mb-3 flex items-center gap-2">
                                <CalendarIcon className="w-5 h-5 text-gray-400" />
                                {yearStats.year}
                            </h3>
                            <div className="space-y-2 text-sm">
                                <div className="flex justify-between">
                                    <span className="text-gray-400">Books Read:</span>
                                    <span className="font-semibold text-white">{yearStats.bookCount}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-400">Pages Read:</span>
                                    <span className="font-semibold text-white">{yearStats.pageCount.toLocaleString()}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-400">Avg. Rating:</span>
                                    <span className="font-semibold text-white">{yearStats.averageRating.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // --- Main App Component ---
        function App() {
            const [books] = useState(hardcodedBooks.map((book, index) => ({ ...book, id: index })));
            const [searchTerm, setSearchTerm] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: 'dateFinished', direction: 'descending' });
            const [selectedBook, setSelectedBook] = useState(null);
            const [view, setView] = useState('metrics'); // 'metrics' or 'library'
            
            const metrics = useMemo(() => {
                const yearlyData = {};
                let totalPages = 0;
                let totalBooks = 0;

                books.forEach(book => {
                    const year = book.dateFinished?.substring(0, 4);
                    if (year && !isNaN(year)) {
                        if (!yearlyData[year]) {
                            yearlyData[year] = { bookCount: 0, pageCount: 0, ratingSum: 0, ratedBooks: 0 };
                        }
                        yearlyData[year].bookCount++;
                        yearlyData[year].pageCount += book.pages || 0;
                        
                        const rating = parseInt(book.rating, 10);
                        if (!isNaN(rating)) {
                            yearlyData[year].ratingSum += rating;
                            yearlyData[year].ratedBooks++;
                        }
                        
                        totalPages += book.pages || 0;
                        totalBooks++;
                    }
                });

                const byYear = Object.keys(yearlyData).map(year => ({
                    year,
                    bookCount: yearlyData[year].bookCount,
                    pageCount: yearlyData[year].pageCount,
                    averageRating: yearlyData[year].ratedBooks > 0 ? yearlyData[year].ratingSum / yearlyData[year].ratedBooks : 0
                })).sort((a, b) => b.year - a.year);

                return { totalBooks, totalPages, byYear };
            }, [books]);

            const sortedAndFilteredBooks = useMemo(() => {
                let filtered = [...books];
                if (searchTerm) {
                    const lowercasedTerm = searchTerm.toLowerCase();
                    filtered = filtered.filter(book =>
                        book.title?.toLowerCase().includes(lowercasedTerm) ||
                        book.author?.toLowerCase().includes(lowercasedTerm) ||
                        book.series?.toLowerCase().includes(lowercasedTerm) ||
                        book.genre?.toLowerCase().includes(lowercasedTerm) ||
                        (book.dateFinished && book.dateFinished.toString().includes(lowercasedTerm))
                    );
                }
                if (sortConfig.key) {
                    filtered.sort((a, b) => {
                        const aValue = a[sortConfig.key];
                        const bValue = b[sortConfig.key];
                        if (aValue < bValue) return sortConfig.direction === 'ascending' ? -1 : 1;
                        if (aValue > bValue) return sortConfig.direction === 'ascending' ? 1 : -1;
                        return 0;
                    });
                }
                return filtered;
            }, [books, searchTerm, sortConfig]);

            const handleSort = (key) => {
                let direction = 'ascending';
                if (sortConfig.key === key && sortConfig.direction === 'ascending') {
                    direction = 'descending';
                }
                setSortConfig({ key, direction });
            };

            const SortableHeader = ({ label, columnKey }) => (
                <th className="p-3 text-left text-sm font-bold text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700" onClick={() => handleSort(columnKey)}>
                    <div className="flex items-center">
                        <span>{label}</span>
                        {sortConfig.key === columnKey && <ArrowUpDown className="w-4 h-4 ml-2" />}
                    </div>
                </th>
            );

            const getButtonClass = (buttonView) => {
                return view === buttonView
                    ? 'bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg'
                    : 'bg-gray-700 text-gray-300 hover:bg-gray-600 py-2 px-4 rounded-lg';
            };

            return (
                <div className="bg-gray-900 text-gray-100 min-h-screen font-sans p-4 sm:p-6 lg:p-8">
                    <div className="max-w-7xl mx-auto">
                        <header className="mb-6">
                            <div className="flex flex-col sm:flex-row justify-between items-start gap-4">
                                <div>
                                    <h1 className="text-4xl font-bold text-white tracking-tight">Book Reviews</h1>
                                    <p className="text-gray-400 mt-1">
                                        <a href="https://brendanhiggins.dev" target="_blank" rel="noopener noreferrer" className="hover:text-sky-300">Brendan Higgins</a>
                                    </p>
                                </div>
                                <div className="flex space-x-2 bg-gray-800 p-1 rounded-lg">
                                    <button onClick={() => setView('metrics')} className={getButtonClass('metrics')}>
                                        Metrics
                                    </button>
                                    <button onClick={() => setView('library')} className={getButtonClass('library')}>
                                        Library
                                    </button>
                                </div>
                            </div>
                        </header>
                        
                        {view === 'metrics' && <MetricsDashboard metrics={metrics} />}

                        {view === 'library' && (
                            <>
                                <div className="mb-4">
                                    <input
                                        type="text"
                                        placeholder="Search by title, author, series, genre, or year..."
                                        className="w-full p-3 bg-gray-800 border-2 border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 font-mono"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                </div>
                                <div className="bg-gray-800 rounded-2xl shadow-xl overflow-hidden">
                                    <div className="overflow-x-auto">
                                        <table className="min-w-full divide-y divide-gray-700">
                                            <thead className="bg-gray-800">
                                                <tr>
                                                    <SortableHeader label="Title" columnKey="title" />
                                                    <SortableHeader label="Author" columnKey="author" />
                                                    <SortableHeader label="Rating" columnKey="rating" />
                                                    <SortableHeader label="Genre" columnKey="genre" />
                                                    <SortableHeader label="Finished" columnKey="dateFinished" />
                                                </tr>
                                            </thead>
                                            <tbody className="bg-gray-800 divide-y divide-gray-700">
                                                {sortedAndFilteredBooks.length > 0 ? (
                                                    sortedAndFilteredBooks.map(book => (
                                                        <tr key={book.id} className="hover:bg-gray-700/50 transition-colors duration-150">
                                                            <td className="p-4 whitespace-nowrap">
                                                                <div className="font-medium text-white cursor-pointer hover:text-indigo-400" onClick={() => setSelectedBook(book)}>{book.title}</div>
                                                                {book.series && <div className="text-sm text-gray-400">{book.series}</div>}
                                                            </td>
                                                            <td className="p-4 whitespace-nowrap text-gray-300">{book.author}</td>
                                                            <td className="p-4 whitespace-nowrap"><StarRating rating={book.rating} /></td>
                                                            <td className="p-4 whitespace-nowrap">
                                                                <div className="flex flex-wrap">
                                                                    {renderGenreBubbles(book.genre)}
                                                                </div>
                                                            </td>
                                                            <td className="p-4 whitespace-nowrap text-gray-300">{book.dateFinished ? book.dateFinished.substring(0, 4) : 'N/A'}</td>
                                                        </tr>
                                                    ))
                                                ) : (
                                                    <tr><td colSpan="5" className="text-center p-8 text-gray-400">No books found for your search term.</td></tr>
                                                )}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </>
                        )}
                    </div>
                    <BookDetailModal book={selectedBook} isOpen={!!selectedBook} onClose={() => setSelectedBook(null)} />
                </div>
            );
        }

        function BookDetailModal({ book, isOpen, onClose }) {
            if (!book) return null;
            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <div className="text-gray-300 space-y-4">
                        <h2 className="text-3xl font-bold text-sky-300">{book.title}</h2>
                        <p className="text-lg text-gray-400">by <span className="italic">{book.author}</span></p>
                        {book.series && <p className="text-md text-gray-400 mt-1"><span className="font-bold">Series:</span> {book.series}</p>}

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <div className="flex items-center gap-2">
                                <span className="font-bold text-gray-400">Rating:</span>
                                <StarRating rating={book.rating} />
                            </div>

                            <div className="flex items-center gap-2 flex-wrap">
                                <span className="font-bold text-gray-400">Genre:</span>
                                {renderGenreBubbles(book.genre)}
                            </div>
                            <div className="flex items-center gap-2">
                                <span className="font-bold text-gray-400">Pages:</span>
                                <span>{book.pages || 'N/A'}</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <span className="font-bold text-gray-400">Finished:</span>
                                <span>{book.dateFinished ? book.dateFinished.substring(0, 4) : 'N/A'}</span>
                            </div>

                        </div>
                        <div className="prose prose-invert prose-lg max-w-none mt-6 bg-gray-900/50 p-4 rounded-lg">
                            <h4 className="font-bold text-white">Review</h4>
                            <p>{book.review || "No review written yet."}</p>
                        </div>
                        <div className="flex justify-end gap-4 pt-4">
                            <button type="button" onClick={onClose} className="py-2 px-4 bg-teal-600 hover:bg-teal-500 rounded-lg font-semibold transition-colors">Close</button>
                        </div>
                    </div>
                </Modal>
            );
        }

        // --- Mount the React App ---
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>

</body>
</html>
